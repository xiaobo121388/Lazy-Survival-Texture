 /*//// 一键交易 ////*/
{
  "trade_button@common_buttons.light_text_button": {
    "size": [ 48, 18 ],
    "$pressed_button_name": "button.trade",
    "$button_text": "trade.trade",
    "bindings": [
      {
        "binding_name": "#trade_button_enabled",
        "binding_name_override": "#enabled"
      }
    ]
  },
  "trade_button_all@common_buttons.light_text_button": {
    "size": [ 48, 18 ],
    "$button_text": "一键交易",
    "property_bag": {
      "#collection_name": "trade2_result_item"
    },
    "button_mappings": [
      {
        "from_button_id": "button.menu_select",
        "to_button_id": "button.container_auto_place",
        "mapping_type": "pressed"
      }
    ]
  },
  /*//// 快捷查找附魔物品 ////*/
  "enchanted_book_shortcut@common.dialog_background_hollow_3": {
    "$collection_name": "trade_tiers",
    "max_size": [
      98,
      166
    ],
    "size": [
      "100%c",
      166
    ],
    "controls": [
      {
        "label": {
          "type": "label",
          "offset": [
            28,
            8
          ],
          "size": [
            "100%sm",
            "100%sm"
          ],
          "color": "$title_text_color",
          "text": "stat.itemEnchanted",
          "anchor_from": "top_middle",
          "anchor_to": "top_middle"
        }
      },
      {
        "enchanted_book_tiers": {
          "type": "stack_panel",
          "offset": [
            0,
            23
          ],
          "max_size": [
            98,
            166
          ],
          "orientation": "vertical",
          "size": [
            "100%c",
            "100%"
          ],
          "factory": {
            "name": "selected_pack_factory",
            "control_name": "trade2.enchanted_book_toggle_stack"
          },
          "collection_name": "$collection_name",
          "bindings": [
            {
              "binding_name": "#trade_selector_total",
              "binding_name_override": "#collection_length"
            }
          ]
        }
      }
    ]
  },
  "enchanted_book_toggle_stack": {
    "type": "stack_panel",
    "orientation": "vertical",
    "max_size": [
      98,
      24
    ],
    "size": [
      "100%c",
      "default"
    ],
    "factory": {
      "name": "selected_pack_factory",
      "control_name": "trade2.enchanted_book_toggle_holder"
    },
    "$trade_collection_name": "trades",
    "collection_name": "$trade_collection_name",
    "bindings": [
      {
        "binding_name": "#trade_tier_total",
        "binding_name_override": "#collection_length",
        "binding_type": "collection",
        "binding_collection_name": "$collection_name"
      }
    ]
  },
  "enchanted_book_toggle_holder": {
    "type": "panel",
    "max_size": [
      98,
      24
    ],
    "size": [
      "100%c",
      "100%c + 0.5px"
    ],
    "controls": [
      {
        "grid": {
          "type": "grid",
          "max_size": [
            98,
            24
          ],
          "size": [
            "100%c",
            "100%c"
          ],
          "grid_dimensions": [
            1,
            1
          ],
          "collection_name": "sell_item",
          "controls": [
            {
              "toggle_holder": {
                "size": [
                  98,
                  24
                ],
                "type": "panel",
                "anchor_from": "top_middle",
                "anchor_to": "top_middle",
                "controls": [
                  {
                    "trade_toggle@trade2.trade_toggle": {
                      "size": [
                        82,
                        24
                      ],
                      "max_size": [
                        82,
                        24
                      ],
                      "$checked_control": "trade2.custom_toggle_checked",
                      "$unchecked_control": "trade2.custom_toggle_unchecked",
                      "$button_content": "trade2.enchanted_content_holder",
                      "anchor_from": "top_middle",
                      "anchor_to": "top_middle"
                    }
                  },
                  {
                    "grid": {
                      "type": "grid",
                      "max_size": [
                        98,
                        24
                      ],
                      "size": [
                        "100%c",
                        "100%c"
                      ],
                      "grid_dimensions": [
                        1,
                        1
                      ],
                      "collection_name": "trade_item_1",
                      "controls": [
                        {
                          "toggle_holder": {
                            "size": [
                              98,
                              24
                            ],
                            "type": "panel",
                            "anchor_from": "top_middle",
                            "anchor_to": "top_middle",
                            "controls": [
                              {
                                "image": {
                                  "type": "image",
                                  "layer": 20,
                                  "offset": [
                                    -6,
                                    0
                                  ],
                                  "anchor_from": "right_middle",
                                  "anchor_to": "right_middle",
                                  "size": [
                                    16,
                                    16
                                  ],
                                  "texture": "textures/items/emerald"
                                }
                              },
                              {
                                "stack_count_label@trade2.stack_count_label": {
                                  "layer": 21,
                                  "text": "#trade_item_count",
                                  "offset": [
                                    -6,
                                    0
                                  ],
                                  "anchor_from": "right_middle",
                                  "anchor_to": "right_middle",
                                  "size": [
                                    20,
                                    20
                                  ],
                                  "bindings": [
                                    {
                                      "binding_type": "collection_details"
                                    },
                                    {
                                      "binding_name": "#trade_item_count"
                                    }
                                  ]
                                }
                              }
                            ],
                            "bindings": [
                              {
                                "binding_type": "collection_details"
                              },
                              {
                                "binding_name": "#hover_text"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  }
                ],
                "bindings": [
                  {
                    "binding_type": "collection_details"
                  },
                  {
                    "binding_name": "#hover_text"
                  },
                  {
                    "binding_type": "view",
                    "source_property_name": "(not((#hover_text-'§e'-'§b'-'§d')=#hover_text)) or not((#hover_text-'附魔书')=#hover_text) or not((#hover_text-'Enchanted Book')=#hover_text)",
                    "target_property_name": "#visible"
                  }
                ]
              }
            }
          ]
        }
      }
    ]
  },
  "custom_toggle_unchecked": {
    "type": "panel",
    "controls": [
      {
        "toggle_checked_normal@common_toggles.toggle_unchecked": {
          "$new_ui_button_texture": "textures/ui/button_borderless_dark",
          "bindings": [
            {
              "binding_type": "collection_details"
            },
            {
              "binding_name": "#trade_possible",
              "binding_name_override": "#visible"
            }
          ]
        }
      },
      {
        "toggle_checked_red@common_toggles.toggle_unchecked": {
          "$new_ui_button_texture": "textures/ui/button_trade_red",
          "bindings": [
            {
              "binding_type": "collection_details"
            },
            {
              "binding_name": "(not #trade_possible)",
              "binding_name_override": "#visible"
            }
          ]
        }
      }
    ]
  },
  "custom_toggle_checked": {
    "type": "panel",
    "controls": [
      {
        "toggle_checked_normal@common_toggles.toggle_checked": {
          "$new_ui_button_texture": "textures/ui/button_borderless_darkpressed",
          "bindings": [
            {
              "binding_type": "collection_details"
            },
            {
              "binding_name": "#trade_possible",
              "binding_name_override": "#visible"
            }
          ]
        }
      },
      {
        "toggle_checked_red@common_toggles.toggle_checked": {
          "$new_ui_button_texture": "textures/ui/button_trade_red_pressed",
          "bindings": [
            {
              "binding_type": "collection_details"
            },
            {
              "binding_name": "(not #trade_possible)",
              "binding_name_override": "#visible"
            }
          ]
        }
      }
    ]
  },
  "enchanted_content_holder": {
    "type": "stack_panel",
    "orientation": "horizontal",
    "size": [
      "100%c",
      "100%"
    ],
    "anchor_from": "left_middle",
    "anchor_to": "left_middle",
    "controls": [
      {
        "single_item_grid@single_item_grid": {
          "size": [
            16,
            16
          ]
        }
      },
      {
        "text": {
          "type": "label",
          "text": "#hover_text",
          "max_size": [
            104,
            24
          ],
          "bindings": [
            {
              "binding_type": "collection_details"
            },
            {
              "binding_name": "#hover_text"
            }
          ]
        }
      }
    ]
  },
  "screen_stack_panel": {
    "controls": [
      {
        "left_panel@trade2.left_panel": {}
      },
      {
        "center_fold@trade2.center_fold": {}
      },
      {
        "refresh_anchor@trade2.refresh_anchor": {}
      },
      {
        "right_panel@trade2.right_panel": {}
      },
      {
        "toolbar_anchor@trade2.toolbar_anchor": {}
      },
      {
        "enchanted_book_shortcut@trade2.enchanted_book_shortcut": {}
      }
    ]
  },
  /*//// 交易解锁 ////*/
  "trade_toggle": {
    "$toggle_enabled_binding_name": "#toggle_enabled",
    "$toggle_enabled_binding_condition": "always",
    "$unchecked_control": "trade2.trade_toggle_unchecked",
    "$checked_control": "trade2.trade_toggle_checked",
    "$unchecked_locked_control": "trade2.trade_toggle_checked",
    "$unchecked_locked_hover_control": "trade2.trade_toggle_checked",
    "$checked_locked_control": "trade2.trade_toggle_checked",
    "$checked_locked_hover_control": "trade2.trade_toggle_checked",
    "property_bag": {
      "#collection_name": "trade2_result_item"
    }
    // "button_mappings": [
    //   {
    //     "from_button_id": "button.menu_select",
    //     "to_button_id": "button.container_auto_place",
    //     "mapping_type": "double_pressed"
    //   },
    //   {
    //     "from_button_id": "button.menu_ok",
    //     "to_button_id": "button.container_auto_place",
    //     "mapping_type": "double_pressed"
    //   }
    // ]
  },
  "tier_stack_panel": {
    "bindings": []
  },
  "hover_button": {
    "bindings": []
  },
  "arrow_holder/arrow_image": {
    "bindings": []
  },
  "arrow_holder": {
    "modifications": [
      {
        "control_name": "lock_image",
        "operation": "remove"
      }
    ]
  },

  ///Refresh Button///
  "refresh_panel": {
    "anchor_from": "top_left",
          "anchor_to": "bottom_left",
    "type": "panel",
    "size": [
      "100%c",
      20
    ],
    "controls": [
      {
        "toolbar_background@trade2.toolbar_background": {
          "size": [
            "100%cm",
            "100% + 8px"
          ],
          "offset": [
            0,
            -3
          ],
          "anchor_from": "top_left",
          "anchor_to": "top_left",
          "controls": [
            {
              "toolbar_stack_panel": {
                "type": "stack_panel",
                "orientation": "horizontal",
                "size": [
                  "default",
                  "100% - 8px"
                ],
                "offset": [
                  0,
                  3
                ],
                "anchor_from": "top_middle",
                "anchor_to": "top_middle",
                "controls": [
                  {
                    "padding_1": {
                      "type": "panel",
                      "size": [
                        6,
                        0
                      ]
                    }
                  },
                  {
                    "close_button_panel": {
                      "type": "panel",
                      "layer": 100,
                      "size": [
                        "100%c",
                        "100%"
                      ],
                      "controls": [
                        {
                          "test_button@common.button": {
                            "size": [
                              "100%cm",
                              "100%cm"
                            ],
                            "offset": [
                              0,
                              0
                            ],
                            "anchor_from": "center",
                            "anchor_to": "center",
                            "button_mappings": [
                              {
                                "from_button_id": "button.menu_select",
                                "to_button_id": "#xiaobo_trade_refresh",
                                "mapping_type": "pressed"
                              },
                              {
                                "from_button_id": "button.menu_ok",
                                "to_button_id": "$pressed_button_name",
                                "mapping_type": "focused"
                              }
                            ],
                            "controls": [
                              {
                                "default@trade2.refresh_icon": {}
                              },
                              {
                                // 悬停状态
                                "hover@trade2.refresh_icon_hover": {
                                  "$icon_alpha": 0.8
                                }
                              },
                              {
                                // 按下状态
                                "pressed@trade2.refresh_icon_pressed": {}
                              }
                            ]
                          }
                        }
                      ]
                    }
                  },
                  {
                    "padding_2": {
                      "type": "panel",
                      "size": [
                        6,
                        0
                      ]
                    }
                  }
                ]
              }
            }
          ]
        }
      }
    ]
  },
  "refresh_icon_hover": {
    "type": "image",
    "texture": "textures/ui/refresh_white_hover",
    "layer": 3,
    "size": [
      16,
      16
    ],
    "alpha": "$icon_alpha",
    "$icon_alpha|default": 1
  },
  "refresh_icon": {
    "type": "image",
    "texture": "textures/ui/refresh_white_normal",
    "layer": 3,
    "size": [
      16,
      16
    ],
    "alpha": "$icon_alpha",
    "$icon_alpha|default": 1
  },
  "refresh_icon_pressed": {
    "type": "image",
    "texture": "textures/ui/refresh_white_normal_pressed",
    "layer": 3,
    "size": [
      16,
      16
    ],
    "alpha": "$icon_alpha",
    "$icon_alpha|default": 1
  },
  "refresh_anchor": {
    "type": "panel",
    "size": [
      0,
      0
    ],
    "inherit_max_sibling_height": true,
    "controls": [
    ]
  },

  /*//Remove how to play button//*/
  "top_half_stack_panel": {
    "type": "stack_panel",
    "orientation": "horizontal",
    "size": [ "100%c", "100%cm" ],
    "controls": [
      {
        "item_slots_holder": {
          "type": "panel",
          "size": [ "100%c", "100%c" ],
          "inherit_max_sibling_height": true,
          "controls": [
            { "item_slots_stack_panel@trade2.item_slots_stack_panel": {} }
          ]
        }
      },
      {
        "padding_1": {
          "type": "panel",
          "size": [ 1, 0 ]
        }
      },
      {
        "trade_button_holder": {
          "type": "stack_panel",
          "size": [ 48, "100%c" ],
          "horizontal":"vertical",
          "inherit_max_sibling_height": true,
          "controls": [
            { "trade_button@trade2.trade_button": {} },
            { "trade_button_all@trade2.trade_button_all": {} }
          ]
        }
      }
    ]
  },
  "alpha_1": {
    "anim_type": "alpha",
    "from": 0,
    "to": 0,
    "duration": 15,
    "next": "@trade2.alpha_2"
  },
  "alpha_2": {
    "anim_type": "alpha",
    "from": 0,
    "to": 1,
    "duration": 0.2
  },
  "right_panel@common.root_panel": {
    "layer": 1,
    "controls": [
      {
        "common_panel@common.common_panel": {
          "$show_close_button": false,
          "controls": [
            {
              "refresh_panel": {
                "type": "panel",
                "anchor_from": "top_middle",
                "anchor_to": "bottom_middle",
                "size": [
                  "110%c",
                  10
                ],
                "controls": [
                ]
              }
            },
            {
              "bg_image@$dialog_background": {
                "layer": 1
              }
            },
            {
              "dialog_divider@common.dialog_divider": {
                "visible": "$show_divider",
                "anchor_from": "top_left",
                "anchor_to": "top_left",
                "offset": "$divider_offset",
                "size": "$divider_size",
                "bindings": [
                  {
                    "binding_name": "$divider_visible_binding_name",
                    "binding_name_override": "#visible",
                    "binding_type": "$divider_visible_binding_type"
                  }
                ]
              }
            },
            {
              "close_button_holder": {
                "type": "panel",
                "ignored": "(not $show_close_button)",
                "controls": [
                  {
                    "close@common.close_button": {
                      "layer": "$close_button_layer",
                      "offset": "$close_button_offset",
                      "ignored": "$use_compact_close_button"
                    }
                  },
                  {
                    "compact_close@common.compact_close_button": {
                      "layer": "$close_button_layer",
                      "offset": "$close_button_offset",
                      "ignored": "(not $use_compact_close_button)"
                    }
                  }
                ],
                "bindings": [
                  {
                    "binding_name": "$close_button_visible_binding_name",
                    "binding_name_override": "#visible"
                  }
                ]
              }
            }
          ]
        }
      },
      {
        "trade_screen_inventory": {
          "type": "panel",
          "layer": 2,
          "controls": [
            {
              "villager_name_label@trade2.villager_name_label": {}
            },
            {
              "exp_progress_bar@trade2.exp_progress_bar": {}
            },
            {
              "top_half_panel@trade2.top_half_panel": {}
            },
            {
              "inventory_panel_bottom_half_with_label@common.inventory_panel_bottom_half_with_label": {}
            },
            {
              "hotbar_grid@common.hotbar_grid_template": {}
            }
          ]
        }
      }
    ]
  }
}